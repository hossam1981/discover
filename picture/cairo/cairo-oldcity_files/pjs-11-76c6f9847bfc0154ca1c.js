webpackJsonp([11],{lNQg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"SearchTypeahead",function(){return F});var n=r("d6ZO"),v=r.n(n),a=r("DUIN"),o=r("tQ0j"),c=r.n(o),l=r("GGB8"),E=r.n(l),s=r("W/Cr"),u=r("IaRT"),i=r.n(u),S=r("nX0T"),_=r("skut"),p=r("JyNp"),d=r("i0Ug"),m=r("suNN"),y=r("6szS"),f=r("gEaE"),h=r("MQ2h"),b=r.n(h);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function O(e){return w(e)||T(e)||I()}function I(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function T(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function w(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,r){return t&&k(e.prototype,t),r&&k(e,r),e}function j(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?C(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}function N(e,t){return(N=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P="board",G="query",L="recent_query",M="recommended_query",B="trending",K="user",D="new_recipe",H="new_decor",U="new_style",z=38,W=function e(t){var r=t.children;return v.a.createElement(f.b,{flex:"none",height:z,marginRight:2,width:z},r)},F=function(e){function o(){var e,a;x(this,o);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Q(C(C(a=j(this,(e=A(o)).call.apply(e,[this].concat(r))))),"handleOnClickItem",function(e){var t=a.props,r,n;(0,t.onTypeaheadItemSelected)(e,t.value)}),Q(C(C(a)),"renderLabelAndSubLabel",function(e){var t=e.label,r=e.subLabel,n=e.verified,a=void 0!==n&&n;return v.a.createElement(f.b,{overflow:"hidden"},v.a.createElement(f.b,{alignItems:"center",display:"flex"},v.a.createElement(f.b,{flex:"grow"},v.a.createElement(f.K,{bold:!0,truncate:!0},t)),a&&v.a.createElement(f.b,{display:"inlineBlock",flex:"none",marginLeft:1},v.a.createElement(f.n,{accessibilityLabel:s.a._("Verified user icon","Accessibility label for verified icon"),color:"red",icon:"check-circle",size:14}))),r&&v.a.createElement(f.b,{marginTop:1},v.a.createElement(f.K,{size:"xs",truncate:!0},r)))}),Q(C(C(a)),"renderSearchAllInScopeText",function(e){return v.a.createElement(f.K,{bold:!0,truncate:!0},e)}),a}return q(o,e),R(o,[{key:"UNSAFE_componentWillReceiveProps",value:function e(t){var r=this.props,n=r.emptySuggestions,a=r.updateEmptySuggestions;t.emptySuggestions&&n!==t.emptySuggestions&&a(t.emptySuggestions)}},{key:"getTypeaheadGroupTitle",value:function e(t){switch(t){case K:return s.a._("People");case P:return s.a._("Boards");case L:return s.a._("Recent searches");case M:return s.a._("Ideas for you");case B:return s.a._("Trending ideas");case D:return s.a._("Make a new recipe");case H:return s.a._("Spruce up your space");case U:return s.a._("Discover your style");default:return null}}},{key:"getGroupedResults",value:function e(t){return c.a.groupBy(t,function(e){return e.type})}},{key:"renderTypeaheadGroupHeader",value:function e(t){var r=this.getTypeaheadGroupTitle(t);return r&&v.a.createElement("a",{className:"titleItem",style:{cursor:"default",backgroundColor:"inherit"}},v.a.createElement(f.K,{truncate:!0,size:"xs"},r))}},{key:"renderTypeaheadGroupItem",value:function e(n,t){var a=this,r=this.props.typeaheadSuggestionsQuery,o={backgroundColor:t?"#f1f1f1":"inherit",color:n.color?n.color:""};switch(n.type){case G:var c=r.toLowerCase(),l="",u="";return u=n.label.startsWith(c)?(l=c,n.label.slice(c.length)):n.label,v.a.createElement("a",{"data-test-id":"search-suggestion",style:o},v.a.createElement(f.K,{truncate:!0},v.a.createElement(f.K,{bold:!0,color:"gray",inline:!0},l),v.a.createElement(f.K,{bold:!0,inline:!0},u)));case K:return n.searchAllInScope?v.a.createElement("a",{className:"user",style:o},this.renderSearchAllInScopeText(Object(m.b)(s.a._('Pinners named "{{ searchText }}"',"See all Pinner results for a search query"),{searchText:r}))):v.a.createElement("a",{className:"user",style:o},v.a.createElement(f.b,{alignItems:"center",display:"flex"},v.a.createElement(W,null,v.a.createElement(f.a,{name:n.label,src:n.image_medium_url||n.image_small_url})),this.renderLabelAndSubLabel(n)));case P:return n.searchAllInScope?v.a.createElement("a",{className:"board",style:o},this.renderSearchAllInScopeText(Object(m.b)(s.a._('Boards called "{{ searchText }}"',"See all Board results for a search query"),{searchText:r}))):v.a.createElement("a",{className:"board",style:o},v.a.createElement(f.b,{alignItems:"center",display:"flex"},v.a.createElement(W,null,v.a.createElement(f.u,{shape:"rounded",height:z},n.board_thumb_url?v.a.createElement(f.p,{alt:n.label,fit:"cover",naturalHeight:z,naturalWidth:z,src:n.board_thumb_url}):v.a.createElement(f.b,{color:"lightGray",width:z,height:z}))),this.renderLabelAndSubLabel(n)));case L:return v.a.createElement("a",{className:"recentQuery",style:o},v.a.createElement(f.b,{alignItems:"center",display:"flex"},v.a.createElement(f.b,{flex:"grow"},v.a.createElement(f.K,{bold:!0,truncate:!0},n.label)),v.a.createElement(f.b,{display:t?"block":"none",flex:"none",marginBottom:-1,marginTop:-1},v.a.createElement(f.o,{accessibilityLabel:s.a._("Remove","Remove recent search in search typeahead suggestion"),icon:"cancel",onClick:function e(t){var r=t.event;r.stopPropagation(),r.preventDefault(),a.props.removeRecentQuery(n.query)},size:"xs"}))));case M:case B:case D:case H:case U:return v.a.createElement("a",{className:n.class_name,style:o},v.a.createElement(f.K,{bold:!0,truncate:!0},n.label));default:return null}}},{key:"renderTypeaheadGroup",value:function e(n,t,a){var o=this,r=this.props,c=r.hoveredItemIndex,l=r.onHoverItem,u=this.renderTypeaheadGroupHeader(n);return O(u&&[v.a.createElement("li",{key:"group-".concat(n,"-header"),onMouseDown:function e(t){t.preventDefault()}},u)]||[]).concat(O(t.map(function(r,e){var t=a+e;return v.a.createElement("li",{"aria-selected":t===c,key:"group-".concat(n,"-").concat(r.url||e),onBlur:function e(){},onClick:function e(t){t.stopPropagation(),o.handleOnClickItem(r)},onFocus:function e(){return l(t)},onMouseDown:function e(t){t.preventDefault()},onMouseOut:function e(t){t.preventDefault()},onMouseOver:function e(){return l(t)},role:"option"},o.renderTypeaheadGroupItem(r,t===c))})))}},{key:"render",value:function e(){var a=this,t=this.props,r=t.className,n=t.emptySuggestions,o=t.emptySuggestionsOverride,c=t.focused,l=t.maxHeight,u=t.onTypeaheadMouseOut,s=t.onTypeaheadSuggestionsChange,i=t.pinScope,p=t.typeaheadSuggestions,d=t.value,m=null;if(c){var y=v.a.createElement("div",null),f=!d&&(o||n)||p,h=this.getGroupedResults(f),b=l?{maxHeight:l,overflowY:"auto"}:null,g=Object.keys(h).reduce(function(e,t){var r=e.listItems,n=e.globalIndexOffset;return{listItems:O(r).concat(O(a.renderTypeaheadGroup(t,h[t],n))),globalIndexOffset:n+h[t].length}},{listItems:[],globalIndexOffset:0}).listItems;g&&g.length&&(y=v.a.createElement("div",{className:E()(r,"open","Typeahead","typeaheadWithTitles")},v.a.createElement("ul",{className:"results","data-test-id":"typeaheadResults",onBlur:u,onMouseOut:u,style:b,role:"listbox"},g))),m=v.a.createElement(S.a,{view:2,viewParameter:103},y)}return v.a.createElement(_.a,{onTypeaheadSuggestionsChange:s,resourceName:"AdvancedTypeaheadResource",resourceOptions:{pin_scope:i},allowSearchOnMount:!0,value:d},m)}}]),o}(n.Component);t.default=Object(h.compose)(d.a,Object(p.b)({name:"AdvancedTypeaheadResource",key:"emptySuggestionsResource",options:function e(t){var r;return{term:"",pin_scope:t.pinScope}}},{allowStale:!1}),Object(p.b)({name:"RecommendedQueriesResource",key:"recommendedQueriesResource"}),Object(p.b)({name:"TrendingQueriesResource",key:"trendingQueriesResource"}),Object(a.connect)(function(e){return{emptySuggestions:O((e.search.recentQueries||[]).map(function(e,t){var r=e.query,n;return{class_name:"recentQuery",label:r,query:r,resultIndex:t,type:"recent_query",url:e.url||"/search/pins/?q=".concat(encodeURIComponent(r),"&rs=rs")}})).concat(O(e.search.recommendedQueries.map(function(e,t){var r=e.query,n;return{label:r,query:r,resultIndex:t,type:"recommended_query",url:e.url||"/search/pins/?q=".concat(encodeURIComponent(r),"&rs=rec")}})),O(e.search.trendingQueries.map(function(e,t){var r=e.query,n;return{label:r,query:r,resultIndex:t,type:"trending",url:e.url||"/search/pins/?q=".concat(encodeURIComponent(r),"&rs=trending")}})))}},function(r){return{removeRecentQuery:function e(t){return r(Object(y.a)(t))}}}))(F)}});